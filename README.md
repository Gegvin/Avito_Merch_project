
Avito Merch Project

Это мой проект для стажировки. Я написал его на Go, PostgreSQL , JWT  и Docker Compose. Проект позволяет сотрудникам приобретать мерч за монетки и  переводить их друг другу. Интерфейс простой и понятный, чтобы не пришлось возиться с командной строкой.
(Интерфес самый простой html код. Просто изходя из задачи, сотрудникм было неудобно бы пользоваться командной строкой, поэтому сделал + веб)


Что я реализовал
API эндпоинты:
/api/auth – аутентификация 
/api/register – регистрация нового пользователя
/api/info – получение информации о кошельке, инвентаре и истории транзакций
/api/sendCoin – перевод монет другому сотруднику
/api/buy/{item} – покупка мерча по уникальному названию
Веб-интерфейс:
Страницы для входа, регистрации, просмотра кошелька, покупки мерча и перевода монет.
	
 Тестирование:
 •	Я написал юнит-тесты для сервисов и репозитория, а также интеграционные тесты для проверки работы API. В итоге общее покрытие тестами получилось больше 40%.

Какие проблемы пришлось решать
	•	Подключение к базе данных:
Сначала я столкнулся с проблемами подключения, так как база в Docker пробрасывалась на порт 5433, а в моём коде использовался стандартный 5432. (как я понял мой стандартный постгрес сидит на 5432 и у них конфликт) Я настроил переменную окружения DB_CONFIG так, чтобы использовать порт 5433 – теперь всё работает как надо.
	•	JWT и защита эндпоинтов:
Защищённые маршруты возвращали 401, потому что JWT не попадал туда (функция getUserDataFromToken искала его в cookie). Мне пришлось изменить интеграционные тесты,  чтобы передавать токен через cookie, теперь запросы проходят корректно.


Как запустить проект
	Через Docker Compose
Убедитесь, что Docker установлен

переходите в директорию проекта 

docker-compose up -d

Приложение будет доступно по адресу http://localhost:8080.




Как запустить тесты
	•	Для юнит-тестов и покрытия:

go test ./... -v -coverprofile=coverage.out



DB_CONFIG="host=localhost port=5433 user=postgres password=postgres dbname=avito_merch sslmode=disable" JWT_SECRET="mysecret" go test ./test/integration -v


